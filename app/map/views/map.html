<div ng-controller="MapController" class="map" resize ng-style="style()">

    <div class="col-xs-7 col-sm-6">
        <div class="legend">
            <ul class="legend-list list-unstyled list-inline">
                <li>
                    <a href ng-click="panToUser()"><i class="fa fa-crosshairs"></i></a>
                </li>
            </ul>
        </div>

        <ui-gmap-google-map 
        center="map.center" 
        zoom="map.zoom" 
        events="map.events" 
        options="map.options"
        id="map-canvas">
            Loading map...
            <ui-gmap-markers 
            models="markers"
            idkey="'idKey'" 
            coords="'coords'"
            icon="'icon'"
            options="'options'"
            events="markerEvents"
            control="markersControl"></ui-gmap-markers>

            <ui-gmap-window 
            show="map.showWindow"
            isIconVisibleOnClick="false"
            options="infoWindow.options"
            coords="infoWindow.model.coords">
                <div>
                    <span ng-bind="map.showWindow"></span>
                    <div ng-show="{{infoWindow.model.cafe}}">
                        <h3>
                            <a ng-href="#cafe/{{infoWindow.model.cafe.id}}">{{infoWindow.model.cafe.name}}</a>
                        </h3>
                        <span>{{infoWindow.model.cafe.location.address}}</span>
                    </div>
                    <div ng-show="{{!infoWindow.model.cafe}}">
                        <h3>You are here!</h3>
                        <p>Drag to search for cafes.</p>
                    </div>
                </div>
            </ui-gmap-window>
        </ui-gmap-google-map>
    </div>

    <div class="col-xs-5 col-sm-6 cafes">
        <div class="cafe-list-container">
            <div class="cafe-numbers">
                <span ng-show="!loadingCafes" ng-bind="cafes.length"></span>
                <span ng-show="loadingCafes">Loading</span>
                Cafes Nearby
                &nbsp; <i ng-show="loadingCafes" class="fa fa-spinner fa-spin"></i>
            </div>
            <div class="cafe-list">
                <div ng-show="cafes.length < 1 && !loadingCafes">
                    Sorry, we couldn't find any cafes. Try another location perhaps?
                </div>
                <ul class="list-unstyled">
                    <li ng-mouseover="triggerMarkerMouseover(cafe.idKey)" ng-mouseleave="triggerMarkerMouseout(cafe.idKey)"  ng-class="{cafe: true, closed: cafe.venue.hours && !cafe.venue.hours.isOpen}" ng-repeat="cafe in cafes" id="{{cafe.idKey}}">
                        <div ng-class="{'cafe-container': true, hover: cafe.idKey == markerCallbacks.currMouseoverId}">
                            <div class="hidden-xs">
                                <img ng-show="getPhotoUrl(cafe)" ng-src="{{getPhotoUrl(cafe)}}">
                                <div ng-show="!getPhotoUrl(cafe)" class="img">
                                    <i class="fa fa-camera"></i>
                                </div>
                            </div>
                            <div>
                               <a ng-href="#cafe/{{cafe.venue.id}}"><div class="a cafe-name">{{cafe.venue.name}}</div></a><br/>
                                <small>{{cafe.venue.location.address || cafe.venue.location.formattedAddress[0]}}</small><small ng-if="cafe.venue.hours.status">, {{cafe.venue.hours.status}}</small>
                            </div>
                        </div>

                    </li>
                </ul>
            </div>
        </div>

        <div class="ad-space">
            Proudly sponsored by
        </div>
    </div>
</div>